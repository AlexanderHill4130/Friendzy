
<%= link_to "Home", root_path %>

<%= form_tag users_path, method: :get do %>
  <%= text_field_tag :query,
    params[:query],
    class: "form-control",
    placeholder: "Find friends"
  %>
<% end %>

<div class="container">
  <div class="row">
    <div class="col-xs-8">
      <div id="friends">
        <% if params[:query].present? %>
        <% sql_query = "first_name ILIKE :query OR last_name ILIKE :query" %>
        <% @users = User.where(sql_query, query: "%#{params[:query]}%") %>
        <% @users.each do |user| %>
          <h4><%= user.first_name + " " + user.last_name %></h4>
          <%= link_to "Add Friend", friendships_path(:friend_id => user), :method => :post %>
          <% end %>
      <% else %>
        <% @users = User.all %>
        <% @users.each do |user| %>
          <h4><%= user.first_name + " " + user.last_name %></h4>
          <%= link_to "Add Friend", friendships_path(:friend_id => user), :method => :post %>
        <% end %>
        <% end %>
      </div>
    </div>
  </div>
</div>
